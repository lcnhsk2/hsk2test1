<!DOCTYPE html>
<html lang="id" translate="no">
<head>
    <meta charset="UTF-8">
    <!-- Viewport untuk semua perangkat -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes, viewport-fit=cover">
    <!-- Mencegah auto‚Äëtranslate -->
    <meta name="google" content="notranslate">
    <!-- Kompatibilitas IE/Edge -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tema warna status bar (iOS) -->
    <meta name="theme-color" content="#2563eb">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>HSK 2 ¬∑ Paket Lengkap ¬∑ 300 Kosakata</title>
    <!-- Google Font dengan swap -->
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* ===== PROTEKSI SELEKSI & SALIN (vendor prefix lengkap) ===== */
        * {
            -webkit-touch-callout: none;      /* iOS long-press menu */
            -webkit-user-select: none;         /* Chrome/Safari/Edge/iOS */
            -khtml-user-select: none;          /* Konqueror */
            -moz-user-select: none;            /* Firefox */
            -ms-user-select: none;             /* IE/Edge */
            user-select: none;                /* CSS3 */
            -webkit-tap-highlight-color: transparent; /* hapus tap highlight */
        }
        /* Izinkan input dan tombol untuk bisa diinteraksi */
        input, textarea, .btn-opsi, .btn-pilih, .btn-bs, .btn-kata,
        .pair-item-left, .pair-item-right, .btn-utama, .btn-review {
            -webkit-user-select: auto;
            -khtml-user-select: auto;
            -moz-user-select: auto;
            -ms-user-select: auto;
            user-select: auto;
        }
        body {
            -webkit-touch-callout: none;
            background: linear-gradient(145deg, #e0f2fe 0%, #bae6fd 100%);
            background-attachment: fixed;
            padding: 30px 20px;
            color: #1e3a5f;
            font-family: 'Quicksand', sans-serif;
            margin: 0;
            min-height: 100vh;
        }
        /* ===== HEADER POKEMON ===== */
        .pokemon-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: linear-gradient(135deg, #facc15 0%, #eab308 100%);
            padding: 18px 30px;
            border-radius: 60px 60px 30px 30px;
            box-shadow: 0 10px 0 #b45309, 0 8px 20px rgba(0,0,0,0.3);
            margin-bottom: 20px;
            border: 3px solid #2d1b0e;
            color: #0f172a;
            flex-wrap: wrap;
        }
        .pokemon-header h1 {
            font-size: 2.2rem;
            font-weight: 700;
            text-shadow: 3px 3px 0 #ffedd5;
            letter-spacing: 2px;
            margin: 0;
        }
        .pokemon-header i {
            font-size: 3rem;
            color: #ffde00;
            text-shadow: 2px 2px 0 #2d1b0e;
        }
        /* ===== TIMER ===== */
        .timer-container {
            background: #1e293b;
            border-radius: 60px;
            padding: 15px 30px;
            margin: 0 0 30px 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 4px solid #fde047;
            color: white;
            font-weight: 700;
            font-size: 1.8rem;
            box-shadow: 8px 8px 0 #0f172a;
            flex-wrap: wrap;
        }
        .timer-box {
            background: #dc2626;
            padding: 10px 25px;
            border-radius: 50px;
            border: 3px solid #fde047;
            color: white;
            font-family: monospace;
            letter-spacing: 5px;
        }
        /* ===== KARTU SOAL ===== */
        .section-card {
            background: rgba(255,255,255,0.8);
            backdrop-filter: blur(8px);
            border: 5px solid #2563eb;
            border-radius: 50px 20px 50px 20px;
            box-shadow: 12px 12px 0 #1e40af, 0 12px 25px rgba(0,0,0,0.2);
            padding: 30px 25px;
            margin-bottom: 50px;
        }
        .section-title {
            background: linear-gradient(145deg, #dc2626, #ef4444);
            display: inline-block;
            padding: 12px 35px;
            border-radius: 40px 10px 40px 10px;
            color: white;
            font-weight: 700;
            font-size: 1.7rem;
            margin-top: -60px;
            margin-bottom: 25px;
            border: 4px solid #fde047;
            box-shadow: 6px 6px 0 #854d0e;
            text-shadow: 2px 2px 0 #3d2b1a;
        }
        .section-title i {
            margin-right: 15px;
            color: #fde047;
        }
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        /* ===== SOAL ITEM ===== */
        .soal-item {
            background: white;
            padding: 18px 20px;
            border-radius: 25px 8px 25px 8px;
            border: 3px solid #6b5a9c;
            box-shadow: 7px 7px 0 #4a3b6b;
            margin-bottom: 20px;
        }
        /* ===== BENAR/SALAH ===== */
        .benar-salah-container {
            display: flex;
            gap: 20px;
            margin-top: 12px;
            flex-wrap: wrap;
        }
        .btn-bs {
            background: #f2f2f2;
            border: 3px solid #444;
            padding: 10px 25px;
            border-radius: 40px;
            font-weight: 700;
            cursor: pointer;
            transition: 0.1s;
            box-shadow: 4px 4px 0 #888;
        }
        .btn-bs.selected { background: #90caf9; border-color: #0d47a1; box-shadow: 2px 2px 0 #0d2c4a; color: #0d1f3a; }
        .btn-bs.benar { background: #3acf3a !important; border-color: #1f7a1f !important; color: white; box-shadow: 2px 2px 0 #0a3b0a; }
        .btn-bs.salah { background: #ff5e5e !important; border-color: #a00000 !important; color: white; box-shadow: 2px 2px 0 #5a0000; }
        /* ===== LISTENING ===== */
        .dialog-box {
            background: #fef9c3;
            padding: 12px;
            border-radius: 20px;
            border: 2px solid #b45309;
            margin-bottom: 12px;
        }
        .dialog-line { font-size: 1.2rem; margin: 5px 0; }
        .pertanyaan { font-size: 1.2rem; font-weight: 700; margin: 12px 0 8px; }
        .opsi-container { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 12px; }
        .btn-opsi {
            background: #f2f2f2; border: 3px solid #444; padding: 10px 15px; border-radius: 30px;
            font-weight: 600; cursor: pointer; transition: 0.1s; box-shadow: 3px 3px 0 #888; text-align: left;
        }
        .btn-opsi.selected { background: #90caf9; border-color: #0d47a1; box-shadow: 2px 2px 0 #0d2c4a; color: #0d1f3a; }
        .btn-opsi.benar { background: #3acf3a !important; border-color: #1f7a1f !important; color: white; box-shadow: 2px 2px 0 #0a3b0a; }
        .btn-opsi.salah { background: #ff5e5e !important; border-color: #a00000 !important; color: white; box-shadow: 2px 2px 0 #5a0000; }
        /* ===== PILIHAN GANDA ===== */
        .btn-pilih {
            background: #f2f2f2; border: 3px solid #444; padding: 12px 25px; border-radius: 30px;
            font-weight: 700; cursor: pointer; transition: 0.1s; box-shadow: 4px 4px 0 #888;
        }
        .btn-pilih.selected { background: #90caf9; border-color: #0d47a1; box-shadow: 2px 2px 0 #0d2c4a; color: #0d1f3a; }
        .btn-pilih.benar { background: #3acf3a !important; border-color: #1f7a1f !important; color: white; box-shadow: 2px 2px 0 #0a3b0a; }
        .btn-pilih.salah { background: #ff5e5e !important; border-color: #a00000 !important; color: white; box-shadow: 2px 2px 0 #5a0000; }
        /* ===== INPUT HANZI ===== */
        .input-kotak {
            background: white; border: 4px solid #7b3f00; border-radius: 20px; padding: 10px 20px;
            font-size: 1.5rem; text-align: center; width: 100%; letter-spacing: 8px;
            font-weight: 600; color: #1e3a5f; box-shadow: inset 3px 3px 0 #bbb;
        }
        .input-kotak.benar { background: #a5d6a5; border-color: #1f7a1f; }
        .input-kotak.salah { background: #ffab91; border-color: #b71c1c; }
        /* ===== BANK KATA ISIAN ===== */
        .bank-kata-container {
            background: #fef3c7; border: 5px dashed #b45309; border-radius: 50px; 
            padding: 20px; margin-bottom: 30px; display: flex; flex-wrap: wrap; gap: 12px;
            align-items: center; justify-content: center;
        }
        .btn-kata {
            background: #ffcb05; border: 3px solid #2d70b0; padding: 10px 25px;
            border-radius: 40px; font-size: 1.4rem; font-weight: 700; color: #1f3c7a;
            box-shadow: 5px 5px 0 #1f4f8a; cursor: pointer; transition: 0.05s;
        }
        .btn-kata:active { transform: scale(0.95); box-shadow: 2px 2px 0 #1f4f8a; }
        .soal-isian {
            background: #f1f8e9; border: 4px solid #558b2f; border-radius: 30px 10px 30px 10px;
            padding: 20px; box-shadow: 8px 8px 0 #33691e;
        }
        .soal-isian p { font-size: 1.3rem; font-weight: 600; margin-bottom: 15px; }
        /* ===== DRAG & DROP MATCHING ===== */
        .pasangan-container { display: flex; justify-content: space-between; gap: 30px; margin-top: 20px; }
        .kolom-pasangan { 
            background: #a1d6e2; border-radius: 25px; padding: 20px; flex: 1; border: 4px solid #1f7a7a; 
            min-height: 350px; position: relative;
        }
        .pair-item-left, .pair-item-right {
            background: #fef9d9; padding: 15px 20px; margin: 12px 0;
            border-radius: 40px 8px 40px 8px; border: 3px solid #b98229;
            font-weight: 600; box-shadow: 5px 5px 0 #7c5e1a; cursor: pointer;
            transition: 0.1s; position: relative;
        }
        .pair-item-left {
            cursor: grab;
            touch-action: none;          /* Mencegah scroll saat drag di touch */
            -webkit-touch-action: none;  /* iOS Safari */
        }
        .pair-item-left.dragging {
            opacity: 0.6;
            box-shadow: 0 0 0 3px #2563eb;
            cursor: grabbing;
        }
        .pair-item-left.paired, .pair-item-right.paired { 
            background: #b8e2f2 !important; 
            border-color: #0f6e8a !important; 
            box-shadow: 2px 2px 0 #0a495a;
            color: #042431;
        }
        .pair-item-left.benar, .pair-item-right.benar { background: #a5d6a5 !important; border-color: #1f7a1f !important; }
        .pair-item-left.salah, .pair-item-right.salah { background: #ffab91 !important; border-color: #b71c1c !important; }
        .drag-ghost {
            position: fixed; 
            background: #ffcb05; 
            padding: 15px 25px;
            border-radius: 40px 8px 40px 8px; 
            border: 3px solid #2d70b0;
            font-weight: 700; 
            color: #1f3c7a; 
            box-shadow: 8px 8px 0 #1f4f8a;
            pointer-events: none; 
            z-index: 9999; 
            transform: translate(-50%, -50%);
            opacity: 0.9; 
            white-space: nowrap;
            display: none;
        }
        /* ===== TOMBOL ===== */
        .btn-utama {
            background: #dc2626; border: none; color: white; padding: 20px 70px;
            font-size: 2rem; border-radius: 80px; font-weight: 700; border-bottom: 10px solid #991b1b;
            margin: 40px auto; cursor: pointer; display: block; transition: 0.05s linear;
        }
        .btn-utama:active { border-bottom-width: 4px; transform: translateY(6px); }
        .btn-review {
            background: #2563eb; border: none; color: white; padding: 15px 50px;
            font-size: 1.8rem; border-radius: 60px; font-weight: 700; border-bottom: 8px solid #1e40af;
            margin: 20px auto; cursor: pointer; display: inline-block; transition: 0.05s linear;
        }
        .btn-review:active { border-bottom-width: 3px; transform: translateY(5px); }
        .laporan-akhir {
            background: #0f172a; color: white; padding: 30px; border-radius: 60px 20px 60px 20px;
            margin-top: 30px; font-size: 1.5rem; border: 6px solid #facc15; text-align: center;
        }
        footer { text-align: center; margin-top: 40px; font-size: 1.3rem; color: #1e3a5f; font-weight: 700; }
        /* ===== RESPONSIF ===== */
        @media (max-width: 900px) {
            .grid-2 { grid-template-columns: 1fr; }
            .pokemon-header h1 { font-size: 1.8rem; }
            .timer-container { font-size: 1.4rem; }
            .timer-box { padding: 8px 20px; }
            .section-title { font-size: 1.4rem; padding: 10px 25px; }
        }
        @media (max-width: 480px) {
            body { padding: 20px 10px; }
            .btn-utama { padding: 15px 30px; font-size: 1.6rem; }
        }
    </style>
</head>
<body oncontextmenu="return false;" oncopy="return false;" oncut="return false;" onselectstart="return false;" ondragstart="return false;">

    <div class="pokemon-header">
        <i class="fas fa-paw"></i>
        <h1>‚ö° HSK 2 ¬∑ ÂÆåÊï¥Ê®°ËÄÉ ¬∑ 300 Kata ‚ö°</h1>
        <i class="fas fa-bolt"></i>
    </div>

    <div class="timer-container">
        <span><i class="fas fa-hourglass-half"></i> Sisa Waktu</span>
        <span class="timer-box" id="timerDisplay">56:00</span>
    </div>

    <p style="text-align: center; font-size: 1.6rem; margin-bottom: 20px; font-weight: 700; background: white; display: inline-block; padding: 10px 35px; border-radius: 40px; border: 4px solid #2563eb;">‚ú® 70 Soal ¬∑ Semua Kata HSK 2 ‚ú®</p>

    <!-- ===== 1. Âà§Êñ≠ÂØπÈîô (10) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-check-circle"></i> Âà§Êñ≠ÂØπÈîô ¬∑ 10</div>
        <div class="grid-2" id="benarSalahContainer"></div>
    </div>

    <!-- ===== 2. LISTENING (10) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-headphones-alt"></i> Âê¨ÂäõÁâπËÆ≠ ¬∑ 10</div>
        <div class="grid-2" id="listening-soal"></div>
    </div>

    <!-- ===== 3. PILIHAN GANDA (10) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-question-circle"></i>  PILIHAN GANDA ¬∑ 10</div>
        <div id="pilihan-ganda-container"></div>
    </div>

    <!-- ===== 4. ISIAN HANZI (10) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-pencil-alt"></i>  ISIAN HANZI ¬∑ 10</div>
        <div id="bankKataIsian" class="bank-kata-container"></div>
        <div id="soal-isian-container" class="grid-2"></div>
    </div>

    <!-- ===== 5. MENGETIK HANZI (PINYIN) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-keyboard"></i>  TULIS HANZI (pinyin) ¬∑ 10</div>
        <div id="ketik-hanzi-grid" class="grid-2"></div>
    </div>

    <!-- ===== 6. INDONESIA ‚Üí HANZI ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-language"></i>  INDONESIA ‚Üí HANZI ¬∑ 10</div>
        <div id="indo-hanzi-grid" class="grid-2"></div>
    </div>

    <!-- ===== 7. MENJODOHKAN DRAG & DROP (2 set) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-link"></i>  JODOHKAN ¬∑ set 1 (5) ‚Äî tarik kiri ke kanan</div>
        <div id="pasangan-set1" class="pasangan-container"></div>
        <div style="margin: 30px 0;"></div>
        <div class="section-title"><i class="fas fa-link"></i>  JODOHKAN ¬∑ set 2 (5) ‚Äî tarik kiri ke kanan</div>
        <div id="pasangan-set2" class="pasangan-container"></div>
    </div>

    <button id="submitGlobalBtn" class="btn-utama"><i class="fas fa-paper-plane"></i> KIRIM SEMUA JAWABAN</button>
    <div id="laporanGlobal" class="laporan-akhir" style="display: none;"></div>
    <footer><i class="fas fa-pokeball"></i>  HSK 2 ¬∑ 70 Soal ¬∑ 300 Kata  <i class="fas fa-pokeball"></i></footer>

    <!-- Ghost element untuk drag & drop -->
    <div id="dragGhost" class="drag-ghost"></div>

    <script>
        (function() {
            // ==================== FUNGSI ACAK ====================
            function shuffleArray(arr) {
                for (let i = arr.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [arr[i], arr[j]] = [arr[j], arr[i]];
                }
                return arr;
            }

            // ========== 1. Âà§Êñ≠ÂØπÈîô (10) ==========
            const bsDataOriginal = [
                { kalimat: "‰ªäÂ§©Â§©Ê∞îÂæàÁÉ≠ÔºåÊàëË¶ÅÂêÉË•øÁìú„ÄÇ", pernyataan: "‰ªäÂ§©ÂæàÂÜ∑ÔºåË¶ÅÂêÉÁæäËÇâ„ÄÇ", jawaban: "S" },
                { kalimat: "Â¶πÂ¶π‰ªäÂπ¥‰∫îÂ≤ÅÔºåÂ•π‰ºöÂî±Ê≠å„ÄÇ", pernyataan: "Â¶πÂ¶π‰∏ç‰ºöÂî±Ê≠å„ÄÇ", jawaban: "S" },
                { kalimat: "ÁÅ´ËΩ¶Á´ôÁ¶ªËøôÈáåÂæàËøúÔºåÊàë‰ª¨ÂùêÂá∫ÁßüËΩ¶ÂéªÂêß„ÄÇ", pernyataan: "ÁÅ´ËΩ¶Á´ôÂæàËøëÔºå‰∏çÁî®ÂùêËΩ¶„ÄÇ", jawaban: "S" },
                { kalimat: "Áà∏Áà∏ÊØèÂ§©Êó©‰∏äÂÖ´ÁÇπ‰∏äÁè≠Ôºå‰∏ãÂçà‰∫îÁÇπ‰∏ãÁè≠„ÄÇ", pernyataan: "Áà∏Áà∏Êó©‰∏äÂÖ´ÁÇπÂéªÂÖ¨Âè∏„ÄÇ", jawaban: "B" },
                { kalimat: "ËãπÊûú‰∏ÄÊñ§‰∏âÂÖÉÔºåÈ¶ôËïâ‰∏ÄÊñ§ÂõõÂÖÉÔºåËãπÊûúÊØîÈ¶ôËïâ‰æøÂÆú„ÄÇ", pernyataan: "È¶ôËïâÊØîËãπÊûúË¥µ„ÄÇ", jawaban: "B" },
                { kalimat: "‰ªñÁóÖ‰∫ÜÔºåÂ§¥ÁñºÔºå‰∏çËÉΩÂéª‰∏äÁè≠„ÄÇ", pernyataan: "‰ªñË∫´‰ΩìÂæàÂ•ΩÔºåÂéª‰∏äÁè≠‰∫Ü„ÄÇ", jawaban: "S" },
                { kalimat: "ÊàëÂßêÂßêÂñúÊ¨¢Ê∏∏Ê≥≥ÔºåÂ•πÊ∏∏ÂæóÂæàÂø´„ÄÇ", pernyataan: "ÂßêÂßê‰∏ç‰ºöÊ∏∏Ê≥≥„ÄÇ", jawaban: "S" },
                { kalimat: "ËøôÊú¨‰π¶ÂæàÊúâÊÑèÊÄùÔºåÊàëÊÉ≥ÂÜçÁúã‰∏ÄÊ¨°„ÄÇ", pernyataan: "‰ªñËßâÂæóËøôÊú¨‰π¶Ê≤°ÊÑèÊÄù„ÄÇ", jawaban: "S" },
                { kalimat: "ÂñÇÔºåËØ∑ÈóÆÂº†ÁªèÁêÜÂú®ÂêóÔºü‚Äî‚Äî ÂØπ‰∏çËµ∑Ôºå‰ªñ‰∏çÂú®„ÄÇ", pernyataan: "Âº†ÁªèÁêÜÂú®ÂÖ¨Âè∏„ÄÇ", jawaban: "S" },
                { kalimat: "ÊòéÂ§©ÊòØ‰Ω†ÁöÑÁîüÊó•ÔºåÁ•ù‰Ω†Âø´‰πêÔºÅ", pernyataan: "ÊòéÂ§©ÊòØÁîüÊó•ÔºåÂæàÈ´òÂÖ¥„ÄÇ", jawaban: "B" }
            ];
            let bsData = shuffleArray([...bsDataOriginal]);
            let bsUserAnswers = new Array(10).fill(null);
            const bsContainer = document.getElementById('benarSalahContainer');
            bsContainer.innerHTML = bsData.map((item, idx) => {
                return `<div class="soal-item" data-bs="${idx}">
                    <p style="font-size:1.2rem; background:#e0f7fa; padding:10px; border-radius:20px;"><i class="fas fa-quote-left"></i> ${item.kalimat}</p>
                    <p style="font-size:1.1rem; font-weight:600; margin-top:12px;">üìå Pernyataan: ${item.pernyataan}</p>
                    <div class="benar-salah-container" id="bs-${idx}">
                        <span class="btn-bs" onclick="pilihBS(${idx}, 'B')" id="bs-${idx}-B"><i class="fas fa-check-circle"></i> BENAR</span>
                        <span class="btn-bs" onclick="pilihBS(${idx}, 'S')" id="bs-${idx}-S"><i class="fas fa-times-circle"></i> SALAH</span>
                    </div>
                </div>`;
            }).join('');
            window.pilihBS = function(idx, pilih) {
                bsUserAnswers[idx] = pilih;
                document.getElementById(`bs-${idx}-B`).classList.remove('selected');
                document.getElementById(`bs-${idx}-S`).classList.remove('selected');
                document.getElementById(`bs-${idx}-${pilih}`).classList.add('selected');
            };

            // ========== 2. LISTENING (10) ==========
            const listeningOriginal = [
                { percakapan: ["Â•≥Ôºö‰Ω†Âë®Êú´ÂñúÊ¨¢ÂÅö‰ªÄ‰πàÔºü", "Áî∑ÔºöÊàëÂñúÊ¨¢ÊâìÁØÆÁêÉÂíåË∑ëÊ≠•„ÄÇ"], pertanyaan: "Áî∑ÁîüÂë®Êú´ÂñúÊ¨¢ÂÅö‰ªÄ‰πàÔºü", opsi: ["A. Ê∏∏Ê≥≥", "B. ÊâìÁØÆÁêÉ", "C. Áù°Ëßâ", "D. Áúã‰π¶"], jawaban: "B" },
                { percakapan: ["Áî∑Ôºö‰Ω†ÂñùËå∂ËøòÊòØÂíñÂï°Ôºü", "Â•≥ÔºöÊàëÂñùËå∂ÔºåË∞¢Ë∞¢„ÄÇ"], pertanyaan: "Â•≥ÁöÑÊÉ≥Âñù‰ªÄ‰πàÔºü", opsi: ["A. ÂíñÂï°", "B. ÁâõÂ•∂", "C. Ëå∂", "D. Ë•øÁìú"], jawaban: "C" },
                { percakapan: ["Â•≥ÔºöËøô‰ª∂Ë°£ÊúçÂ§öÂ∞ëÈí±Ôºü", "Áî∑ÔºöÁ∫¢Ëâ≤ÁöÑ‰∏ÄÁôæÂÖÉÔºåÈªëËâ≤ÁöÑÂÖ´ÂçÅÂÖ´ÂÖÉ„ÄÇ"], pertanyaan: "ÈªëËâ≤ÁöÑË°£ÊúçÂ§öÂ∞ëÈí±Ôºü", opsi: ["A. ‰∏ÄÁôæÂÖÉ", "B. ÂÖ´ÂçÅÂÖ´ÂÖÉ", "C. ‰∫îÂçÅÂÖÉ", "D. ‰πùÂçÅ‰πùÂÖÉ"], jawaban: "B" },
                { percakapan: ["Áî∑Ôºö‰Ω†ÊÄé‰πà‰∏çÂéªÁúãÁîµÂΩ±Ôºü", "Â•≥ÔºöÂõ†‰∏∫ÊàëÊúâÂæàÂ§ö‰Ωú‰∏öË¶ÅÂÜô„ÄÇ"], pertanyaan: "Â•≥ÁöÑ‰∏∫‰ªÄ‰πà‰∏çÂéªÁúãÁîµÂΩ±Ôºü", opsi: ["A. Ë¶ÅÂ∑•‰Ωú", "B. Ë¶ÅÂÜô‰Ωú‰∏ö", "C. Ë∫´‰Ωì‰∏çËàíÊúç", "D. ÁîµÂΩ±‰∏çÂ•ΩÁúã"], jawaban: "B" },
                { percakapan: ["Â•≥ÔºöËØ∑ÈóÆÔºåÂåªÈô¢ÊÄé‰πàËµ∞Ôºü", "Áî∑Ôºö‰ªéËøôÂÑø‰∏ÄÁõ¥ÂæÄ‰∏úËµ∞ÔºåÂú®Èì∂Ë°åÊóÅËæπ„ÄÇ"], pertanyaan: "ÂåªÈô¢Âú®Âì™ÈáåÔºü", opsi: ["A. Èì∂Ë°åÊóÅËæπ", "B. ÁÅ´ËΩ¶Á´ôÊóÅËæπ", "C. Â≠¶Ê†°ÂØπÈù¢", "D. ÂïÜÂ∫óÊóÅËæπ"], jawaban: "A" },
                { percakapan: ["Áî∑Ôºö‰Ω†ÂºüÂºüÂ§öÂ§ß‰∫ÜÔºü", "Â•≥Ôºö‰ªñ‰ªäÂπ¥ÂÖ´Â≤ÅÔºå‰∏äÂ∞èÂ≠¶‰∫åÂπ¥Á∫ß„ÄÇ"], pertanyaan: "ÂºüÂºüÂá†Â≤ÅÔºü", opsi: ["A. ÂÖ≠Â≤Å", "B. ÂÖ´Â≤Å", "C. ‰∏ÉÂ≤Å", "D. ‰πùÂ≤Å"], jawaban: "B" },
                { percakapan: ["Â•≥Ôºö‰Ω†ËßâÂæóËøô‰∏™ËèúÊÄé‰πàÊ†∑Ôºü", "Áî∑ÔºöÂæàÂ•ΩÂêÉÔºå‰ΩÜÊòØÊúâ‰∏ÄÁÇπÂÑøË¥µ„ÄÇ"], pertanyaan: "Áî∑ÁöÑËßâÂæóËèúÊÄé‰πàÊ†∑Ôºü", opsi: ["A. ‰∏çÂ•ΩÂêÉ", "B. ‰æøÂÆú", "C. Â•ΩÂêÉ‰ΩÜÊòØË¥µ", "D. ÂæàÂí∏"], jawaban: "C" },
                { percakapan: ["Áî∑Ôºö‰Ω†ÊØèÂ§©ÊÄé‰πàÂéª‰∏äÁè≠Ôºü", "Â•≥ÔºöÊàëÂùêÂú∞ÈìÅÔºåÂè™Ë¶Å‰∫åÂçÅÂàÜÈíü„ÄÇ"], pertanyaan: "Â•≥ÁöÑÊÄé‰πà‰∏äÁè≠Ôºü", opsi: ["A. ÂùêÂÖ¨ÂÖ±Ê±ΩËΩ¶", "B. È™ëËá™Ë°åËΩ¶", "C. ÂùêÂú∞ÈìÅ", "D. Ëµ∞Ë∑Ø"], jawaban: "C" },
                { percakapan: ["Â•≥Ôºö‰Ω†‰ºöËØ¥Ê±âËØ≠ÂêóÔºü", "Áî∑Ôºö‰ºö‰∏ÄÁÇπÂÑøÔºå‰ΩÜÊòØËØ¥Âæó‰∏çÂø´„ÄÇ"], pertanyaan: "Áî∑ÁöÑÊ±âËØ≠ÊÄé‰πàÊ†∑Ôºü", opsi: ["A. ËØ¥ÂæóÂæàÂø´", "B. ‰∏ç‰ºöËØ¥", "C. ‰ºö‰∏ÄÁÇπÂÑø", "D. ËØ¥ÂæóÂæàÂ•Ω"], jawaban: "C" },
                { percakapan: ["Áî∑ÔºöÊòéÂ§©Â§©Ê∞îÊÄé‰πàÊ†∑Ôºü", "Â•≥ÔºöÂ§©Ê∞îÈ¢ÑÊä•ËØ¥Êô¥Â§©Ôºå‰ΩÜÊòØÂæàÂÜ∑„ÄÇ"], pertanyaan: "ÊòéÂ§©Â§©Ê∞îÊÄé‰πàÊ†∑Ôºü", opsi: ["A. ‰∏ãÈõ™", "B. Êô¥Â§©‰ΩÜÊòØÂÜ∑", "C. Èò¥Â§©", "D. ‰∏ãÈõ®"], jawaban: "B" }
            ];
            let listeningData = shuffleArray([...listeningOriginal]);
            let listeningUserAnswers = new Array(10).fill(null);
            const listeningDiv = document.getElementById('listening-soal');
            listeningDiv.innerHTML = listeningData.map((item, idx) => {
                let dialogHTML = '<div class="dialog-box">';
                item.percakapan.forEach(baris => dialogHTML += `<div class="dialog-line">${baris}</div>`);
                dialogHTML += '</div>';
                dialogHTML += `<div class="pertanyaan">${idx+1}. ${item.pertanyaan}</div><div class="opsi-container">`;
                item.opsi.forEach((opsi, opsiIdx) => {
                    const huruf = String.fromCharCode(65+opsiIdx);
                    dialogHTML += `<span class="btn-opsi" onclick="pilihListening(${idx}, '${huruf}')" id="listen-${idx}-${huruf}">${opsi}</span>`;
                });
                dialogHTML += '</div>';
                return `<div class="soal-item" data-listen="${idx}">${dialogHTML}</div>`;
            }).join('');
            window.pilihListening = function(idx, huruf) {
                listeningUserAnswers[idx] = huruf;
                document.querySelector(`[data-listen="${idx}"]`).querySelectorAll('.btn-opsi').forEach(btn => btn.classList.remove('selected'));
                document.getElementById(`listen-${idx}-${huruf}`).classList.add('selected');
            };

            // ========== 3. PILIHAN GANDA (10) ==========
            const pgOriginal = [
                { soal: "‚Äú‰ªñÊØîÊàëÈ´ò‚ÄùÊòØ‰ªÄ‰πàÊÑèÊÄùÔºü", a: "‰ªñÂíåÊàë‰∏ÄÊ†∑È´ò", b: "‰ªñÊØîÊàëÁüÆ", c: "ÊàëÊØî‰ªñÈ´ò", d: "‰ªñÊØîÊàëÈ´ò", jawab: "d" },
                { soal: "‚ÄúÂõ†‰∏∫‰∏ãÈõ®ÔºåÊâÄ‰ª•Êàë‰∏çÂéªÂÖ¨Âõ≠‰∫Ü„ÄÇ‚Äù ‰∏∫‰ªÄ‰πà‰∏çÂéªÂÖ¨Âõ≠Ôºü", a: "Âõ†‰∏∫Â§™ÁÉ≠", b: "Âõ†‰∏∫‰∏ãÈõ®", c: "Âõ†‰∏∫ÂæàÁ¥Ø", d: "Âõ†‰∏∫Ê≤°Êó∂Èó¥", jawab: "b" },
                { soal: "‚ÄúÊàëÊ≠£Âú®ÂêÉÈ•≠‚Äù‰∏≠ÁöÑ‚ÄúÊ≠£Âú®‚ÄùË°®Á§∫‰ªÄ‰πàÔºü", a: "Â∑≤ÁªèÂÅöÂÆå", b: "Áé∞Âú®ÂÅö", c: "‰ª•ÂêéÂÅö", d: "ÊØèÂ§©ÂÅö", jawab: "b" },
                { soal: "‚Äú‰Ω†ËÆ§ËØÜÈÇ£‰∏™Á©øÁ∫¢Ë°£ÊúçÁöÑÂ•≥‰∫∫ÂêóÔºü‚Äù ÈóÆÁöÑÊòØÔºü", a: "Áî∑‰∫∫", b: "Â≠©Â≠ê", c: "Â•≥‰∫∫", d: "ËÄÅÂ∏à", jawab: "c" },
                { soal: "‚ÄúËãπÊûú‰∏ÄÊñ§‰∫îÂÖÉÔºåÈ¶ôËïâ‰∏ÄÊñ§ÂÖ≠ÂÖÉÔºåÂì™‰∏™‰æøÂÆúÔºü‚Äù", a: "ËãπÊûú‰æøÂÆú", b: "È¶ôËïâ‰æøÂÆú", c: "‰∏ÄÊ†∑‰æøÂÆú", d: "ÈÉΩË¥µ", jawab: "a" },
                { soal: "‚ÄúÂà´Á≠â‰∫ÜÔºå‰ªñÂ∑≤ÁªèËµ∞‰∫Ü„ÄÇ‚Äù‰∏≠ÁöÑ‚ÄúÂà´‚ÄùÊòØ‰ªÄ‰πàÊÑèÊÄùÔºü", a: "‰∏çË¶Å", b: "Âà´ÁöÑ", c: "ÂÜçËßÅ", d: "ÁâπÂà´", jawab: "a" },
                { soal: "‚ÄúÊàëÂßêÂßêÊØîÊàëËÉΩÂπ≤„ÄÇ‚ÄùÁöÑÊÑèÊÄùÊòØÔºü", a: "ÂßêÂßêÂæàËÉΩÂπ≤", b: "Êàë‰∏çËÉΩÂπ≤", c: "ÂßêÂßêÊØîÊàëÂ∑Æ", d: "ÂßêÂßêÊõ¥ÂéâÂÆ≥", jawab: "d" },
                { soal: "‚Äú‰ªéÊàëÂÆ∂Âà∞ÂÖ¨Âè∏ÂæàËøú„ÄÇ‚Äù ÈóÆÔºö‰ªéÂÆ∂Âà∞ÂÖ¨Âè∏Ôºü", a: "ÂæàËøë", b: "‰∏çËøú", c: "ÂæàËøú", d: "‰∏çÁü•ÈÅì", jawab: "c" },
                { soal: "‚Äú‰ªñÊØèÂ§©ÂÖ≠ÁÇπÂ∞±Ëµ∑Â∫ä„ÄÇ‚Äù‰∏≠ÁöÑ‚ÄúÂ∞±‚ÄùË°®Á§∫‰ªÄ‰πàÔºü", a: "ÂæàÊôö", b: "ÂæàÊó©", c: "È©¨‰∏ä", d: "Âè™Êúâ", jawab: "b" },
                { soal: "‚ÄúÊàë‰ª¨‰∏ÄËµ∑ÂéªÂõæ‰π¶È¶ÜÔºåÂ•ΩÂêóÔºü‚Äù ËøôÊòØÔºü", a: "ÂëΩ‰ª§", b: "Âª∫ËÆÆ", c: "ÁñëÈóÆ", d: "ÈôàËø∞", jawab: "b" }
            ];
            let pgData = shuffleArray([...pgOriginal]);
            let pgUserAnswers = new Array(10).fill(null);
            const pgContainer = document.getElementById('pilihan-ganda-container');
            pgContainer.innerHTML = pgData.map((item, idx) => {
                return `<div class="soal-item" data-pg="${idx}">
                    <p style="font-size:1.3rem;font-weight:700;">${idx+1}. ${item.soal}</p>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:15px;">
                        <span class="btn-pilih" onclick="pilihPG(${idx},'a',this)">A. ${item.a}</span>
                        <span class="btn-pilih" onclick="pilihPG(${idx},'b',this)">B. ${item.b}</span>
                        <span class="btn-pilih" onclick="pilihPG(${idx},'c',this)">C. ${item.c}</span>
                        <span class="btn-pilih" onclick="pilihPG(${idx},'d',this)">D. ${item.d}</span>
                    </div>
                </div>`;
            }).join('');
            window.pilihPG = function(idx, pilih, el) {
                pgUserAnswers[idx] = pilih;
                const parent = el.closest('.soal-item');
                parent.querySelectorAll('.btn-pilih').forEach(b => b.classList.remove('selected'));
                el.classList.add('selected');
            };

            // ========== 4. ISIAN HANZI (10) ==========
            const isianSoalOriginal = [
                { kalimat: "ÊòéÂ§©ÊòØÊàëÁöÑÁîü____Ôºå‰Ω†Êù•ÊàëÂÆ∂Áé©Âêß„ÄÇ", jawab: "Êó•" },
                { kalimat: "ËØ∑ÈóÆÔºåÂéªÁÅ´____Á´ôÊÄé‰πàËµ∞Ôºü", jawab: "ËΩ¶" },
                { kalimat: "Êàë____ÂæóËøôÊú¨‰π¶ÂæàÊúâÊÑèÊÄù„ÄÇ", jawab: "Ëßâ" },
                { kalimat: "Â•πÊØèÂ§©‰∏ÉÁÇπËµ∑____„ÄÇ", jawab: "Â∫ä" },
                { kalimat: "Êàë‰ºöÂî±____Ôºå‰πü‰ºöË∑≥Ëàû„ÄÇ", jawab: "Ê≠å" },
                { kalimat: "ËøôÂèåÈûãÂ§™____‰∫ÜÔºåÊúâ‰æøÂÆú‰∏ÄÁÇπÂÑøÁöÑÂêóÔºü", jawab: "Ë¥µ" },
                { kalimat: "‰ªñ____Ê≥≥Ê∏∏ÂæóÂæàÂø´„ÄÇ", jawab: "Ê∏∏" },
                { kalimat: "ÊàëÂú®____ÂÖ¨Âè∏Â∑•‰ΩúÔºåÊòØ‰∏ÄÂêçÂåªÁîü„ÄÇ", jawab: "Âåª" },
                { kalimat: "‰Ω†ÂñùÂíñ____ÂêóÔºü", jawab: "Âï°" },
                { kalimat: "Â•πÊúâ‰∏ÄÂèåÂ§ßÁúºÁùõÔºåÂæà____‰∫Æ„ÄÇ", jawab: "ÊºÇ" }
            ];
            let isianSoal = shuffleArray([...isianSoalOriginal]);
            let bankKataIsian = ["Êó•","ËΩ¶","Ëßâ","Â∫ä","Ê≠å","Ë¥µ","Ê∏∏","Âåª","Âï°","ÊºÇ","ÂêÉ","Áúã","Âê¨","ÂÜô","Áé©","Ë∑ë","Âø´","ÊÖ¢","Êñ∞","Êóß"];
            let bankKataShuffled = shuffleArray([...bankKataIsian]);
            const bankContainer = document.getElementById('bankKataIsian');
            bankContainer.innerHTML = '';
            bankKataShuffled.forEach(kata => {
                const btn = document.createElement('span');
                btn.className = 'btn-kata';
                btn.textContent = kata;
                btn.setAttribute('data-kata', kata);
                btn.onclick = function() {
                    const active = document.activeElement;
                    if (active && active.classList.contains('input-isian')) {
                        active.value = kata;
                    } else {
                        alert('Klik pada kotak input yang ingin diisi terlebih dahulu.');
                    }
                };
                bankContainer.appendChild(btn);
            });
            const isianContainer = document.getElementById('soal-isian-container');
            isianContainer.innerHTML = '';
            isianSoal.forEach((item, idx) => {
                const div = document.createElement('div');
                div.className = 'soal-item soal-isian';
                div.setAttribute('data-isian', idx);
                div.innerHTML = `<p style="font-size:1.3rem;">${idx+1}. ${item.kalimat.replace('____','______')}</p>
                                <input class="input-kotak input-isian" type="text" id="isian-${idx}" data-jawaban="${item.jawab}" placeholder="ketik hanzi" autocomplete="off">`;
                isianContainer.appendChild(div);
            });

            // ========== 5. MENGETIK HANZI (pinyin) ==========
            const hanziOriginal = [
                { pinyin: "chƒ´", arti: "makan", hanzi: "ÂêÉ" },
                { pinyin: "hƒì", arti: "minum", hanzi: "Âñù" },
                { pinyin: "k√†n", arti: "melihat", hanzi: "Áúã" },
                { pinyin: "tƒ´ng", arti: "mendengar", hanzi: "Âê¨" },
                { pinyin: "xiƒõ", arti: "menulis", hanzi: "ÂÜô" },
                { pinyin: "d√∫", arti: "membaca", hanzi: "ËØª" },
                { pinyin: "shu√¨", arti: "tidur", hanzi: "Áù°" },
                { pinyin: "zu√≤", arti: "duduk/melakukan", hanzi: "ÂÅö" },
                { pinyin: "m«éi", arti: "membeli", hanzi: "‰π∞" },
                { pinyin: "s√≤ng", arti: "mengantar", hanzi: "ÈÄÅ" }
            ];
            let hanziFromPinyin = shuffleArray([...hanziOriginal]);
            const ketikGrid = document.getElementById('ketik-hanzi-grid');
            ketikGrid.innerHTML = hanziFromPinyin.map((item, idx) => {
                return `<div class="soal-item">
                    <p style="font-size:1.2rem;"><strong>${idx+1}. ${item.pinyin}</strong> (${item.arti})</p>
                    <input class="input-kotak" type="text" id="hanziInput${idx}" placeholder="ketik hanzi" autocomplete="off">
                </div>`;
            }).join('');

            // ========== 6. INDONESIA ‚Üí HANZI ==========
            const indoOriginal = [
                { arti: "mobil", hanzi: "ËΩ¶" },
                { arti: "sepeda", hanzi: "Ëá™Ë°åËΩ¶" },
                { arti: "nasi", hanzi: "Á±≥È•≠" },
                { arti: "mie", hanzi: "Èù¢Êù°" },
                { arti: "teh", hanzi: "Ëå∂" },
                { arti: "kopi", hanzi: "ÂíñÂï°" },
                { arti: "apel", hanzi: "ËãπÊûú" },
                { arti: "pisang", hanzi: "È¶ôËïâ" },
                { arti: "buku", hanzi: "‰π¶" },
                { arti: "jam tangan", hanzi: "ÊâãË°®" }
            ];
            let indoToHanzi = shuffleArray([...indoOriginal]);
            const indoGrid = document.getElementById('indo-hanzi-grid');
            indoGrid.innerHTML = indoToHanzi.map((item, idx) => {
                return `<div class="soal-item">
                    <p style="font-size:1.3rem;"><strong>${idx+1}. ${item.arti}</strong></p>
                    <input class="input-kotak" type="text" id="indoInput${idx}" placeholder="tulis hanzi" autocomplete="off">
                </div>`;
            }).join('');

            // ========== 7. DRAG & DROP MATCHING (2 set) ==========
            const set1Pairs = [
                { left: "‰Ω†ÊòéÂ§©ÊúâÁ©∫Âêó", right: "ÂØπ‰∏çËµ∑ÔºåÊàëË¶ÅÂéªÂåªÈô¢" },
                { left: "Ëøô‰∏™ËãπÊûúÂ§öÂ∞ëÈí±", right: "‰∏ÄÊñ§‰∏âÂÖÉ" },
                { left: "‰Ω†Âì•Âì•‰ºöÊ∏∏Ê≥≥Âêó", right: "‰ºöÔºå‰ªñÊ∏∏ÂæóÂæàÂ•Ω" },
                { left: "Êàë‰ª¨ÂùêÂÖ¨ÂÖ±Ê±ΩËΩ¶Âéª", right: "Â•ΩÁöÑÔºåËΩ¶Á´ôÂú®ÊóÅËæπ" },
                { left: "‰Ω†‰∏∫‰ªÄ‰πàÂñúÊ¨¢‰∏≠ÂõΩ", right: "Âõ†‰∏∫ÊàëÂæàÁà±ÂêÉ‰∏≠ÂõΩËèú" }
            ];
            const set2Pairs = [
                { left: "‰Ω†Â•≥ÂÑøÂá†Â≤Å‰∫Ü", right: "Â•π‰ªäÂπ¥‰∫îÂ≤Å" },
                { left: "Êôö‰∏ä‰Ω†ÊÉ≥ÂêÉ‰ªÄ‰πà", right: "ÊàëÊÉ≥ÂêÉÈ•∫Â≠ê" },
                { left: "‰Ω†Áà∏Áà∏Âú®ÂÖ¨Âè∏Âêó", right: "‰∏çÂú®Ôºå‰ªñÂá∫Â∑Æ‰∫Ü" },
                { left: "Ëøô‰ª∂Ë°£ÊúçÊºÇ‰∫ÆÂêó", right: "ÂæàÊºÇ‰∫ÆÔºå‰ΩÜÊòØÂ§™Ë¥µ‰∫Ü" },
                { left: "‰Ω†ËßâÂæóÊ±âËØ≠ÈöæÂêó", right: "‰∏çÈöæÔºåÂæàÊúâÊÑèÊÄù" }
            ];
            let pairSet1 = {}; let pairSet2 = {};
            for (let i=0; i<5; i++) { pairSet1[i] = null; pairSet2[i] = null; }

            // Drag state
            let dragActive = false, draggedElement = null, draggedSet = null, draggedLeftIdx = null;
            let ghost = document.getElementById('dragGhost');

            function renderDragDropSet(setId, pairs, containerId) {
                let leftItems = pairs.map(p => p.left);
                let rightItems = pairs.map(p => p.right);
                leftItems = shuffleArray(leftItems);
                rightItems = shuffleArray(rightItems);
                const cont = document.getElementById(containerId);
                cont.innerHTML = `<div class="kolom-pasangan" id="left-${setId}">
                                    <h3 style="background:#ffb347;padding:10px;border-radius:30px;">‚¨ÖÔ∏è Kiri (tarik)</h3>
                                    <div id="left-${setId}-list"></div>
                                  </div>
                                  <div class="kolom-pasangan" id="right-${setId}">
                                    <h3 style="background:#6ac46a;padding:10px;border-radius:30px;">‚û°Ô∏è Kanan (lepas)</h3>
                                    <div id="right-${setId}-list"></div>
                                  </div>`;
                const leftList = document.getElementById(`left-${setId}-list`);
                const rightList = document.getElementById(`right-${setId}-list`);
                window[`pairMap${setId}`] = {};
                pairs.forEach(p => { window[`pairMap${setId}`][p.left] = p.right; });
                leftItems.forEach((txt, i) => {
                    let div = document.createElement('div');
                    div.className = 'pair-item-left';
                    div.id = `left-${setId}-${i}`;
                    div.innerHTML = txt;
                    div.setAttribute('data-left-text', txt);
                    div.setAttribute('data-left-idx', i);
                    div.setAttribute('data-set', setId);
                    div.addEventListener('pointerdown', dragStartHandler);
                    leftList.appendChild(div);
                });
                rightItems.forEach((txt, i) => {
                    let div = document.createElement('div');
                    div.className = 'pair-item-right';
                    div.id = `right-${setId}-${i}`;
                    div.innerHTML = txt;
                    div.setAttribute('data-right-text', txt);
                    div.setAttribute('data-right-idx', i);
                    div.setAttribute('data-set', setId);
                    div.addEventListener('pointerup', dropHandler);
                    div.addEventListener('pointerenter', dragEnterHandler);
                    rightList.appendChild(div);
                });
            }

            function dragStartHandler(e) {
                e.preventDefault();
                if (dragActive) return;
                draggedElement = this;
                draggedSet = this.getAttribute('data-set');
                draggedLeftIdx = parseInt(this.getAttribute('data-left-idx'));
                ghost.textContent = this.textContent;
                ghost.style.display = 'block';
                updateGhostPosition(e);
                this.classList.add('dragging');
                dragActive = true;
                window.addEventListener('pointermove', dragMoveHandler);
                window.addEventListener('pointerup', dragEndHandler);
                window.addEventListener('pointercancel', dragEndHandler);
            }
            function dragMoveHandler(e) {
                if (!dragActive) return;
                e.preventDefault();
                updateGhostPosition(e);
            }
            function dragEnterHandler(e) {
                if (!dragActive) return;
                e.preventDefault();
            }
            function dropHandler(e) {
                if (!dragActive) return;
                e.preventDefault();
                const rightSet = this.getAttribute('data-set');
                const rightText = this.getAttribute('data-right-text');
                if (rightSet !== draggedSet) { dragEndHandler(e); return; }
                const store = (draggedSet === 's1') ? pairSet1 : pairSet2;
                const prevRightText = store[draggedLeftIdx];
                if (prevRightText) {
                    draggedElement.classList.remove('paired');
                    const prevRightEls = document.querySelectorAll(`#right-${draggedSet} .pair-item-right`);
                    prevRightEls.forEach(el => {
                        if (el.getAttribute('data-right-text') === prevRightText) el.classList.remove('paired');
                    });
                }
                const rightEls = document.querySelectorAll(`#right-${draggedSet} .pair-item-right`);
                rightEls.forEach(el => {
                    if (el.getAttribute('data-right-text') === rightText) {
                        el.classList.remove('paired');
                        for (let key in store) {
                            if (store[key] === rightText) {
                                store[key] = null;
                                const leftEl = document.getElementById(`left-${draggedSet}-${key}`);
                                if (leftEl) leftEl.classList.remove('paired');
                            }
                        }
                    }
                });
                store[draggedLeftIdx] = rightText;
                draggedElement.classList.add('paired');
                this.classList.add('paired');
                dragEndHandler(e);
            }
            function updateGhostPosition(e) {
                let x, y;
                if (e.touches) {
                    x = e.touches[0].clientX;
                    y = e.touches[0].clientY;
                } else {
                    x = e.clientX;
                    y = e.clientY;
                }
                ghost.style.left = x + 'px';
                ghost.style.top = y + 'px';
            }
            function dragEndHandler(e) {
                if (!dragActive) return;
                e.preventDefault();
                ghost.style.display = 'none';
                if (draggedElement) draggedElement.classList.remove('dragging');
                window.removeEventListener('pointermove', dragMoveHandler);
                window.removeEventListener('pointerup', dragEndHandler);
                window.removeEventListener('pointercancel', dragEndHandler);
                dragActive = false;
                draggedElement = null;
                draggedSet = null;
                draggedLeftIdx = null;
            }

            renderDragDropSet('s1', set1Pairs, 'pasangan-set1');
            renderDragDropSet('s2', set2Pairs, 'pasangan-set2');

            // ========== TIMER ==========
            const TOTAL_SOAL = 70;
            const TIME_MINUTES = Math.floor(TOTAL_SOAL * 0.8);
            let timeLeft = TIME_MINUTES * 60;
            const timerDisplay = document.getElementById('timerDisplay');
            let timerInterval = setInterval(function() {
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timerDisplay.textContent = "00:00";
                    document.getElementById('submitGlobalBtn').click();
                } else {
                    timeLeft--;
                    let minutes = Math.floor(timeLeft / 60);
                    let seconds = timeLeft % 60;
                    timerDisplay.textContent = `${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`;
                }
            }, 1000);

            // ========== EVALUASI GLOBAL (target 80%) ==========
            window.evaluasiGlobal = function() {
                let totalBenar = 0;
                const totalSoal = 70;

                // 1. Âà§Êñ≠ÂØπÈîô
                for (let i=0; i<10; i++) {
                    const user = bsUserAnswers[i];
                    const correct = bsData[i].jawaban;
                    const parent = document.querySelector(`[data-bs="${i}"]`);
                    if (parent) {
                        const btns = parent.querySelectorAll('.btn-bs');
                        btns.forEach(b => b.classList.remove('benar','salah'));
                        if (user) {
                            const selectedBtn = document.getElementById(`bs-${i}-${user}`);
                            if (user === correct) { totalBenar++; selectedBtn.classList.add('benar'); }
                            else selectedBtn.classList.add('salah');
                        }
                    }
                }

                // 2. Listening
                for (let i=0; i<10; i++) {
                    const user = listeningUserAnswers[i];
                    const correct = listeningData[i].jawaban;
                    const parent = document.querySelector(`[data-listen="${i}"]`);
                    if (parent) {
                        const btns = parent.querySelectorAll('.btn-opsi');
                        btns.forEach(b => b.classList.remove('benar','salah'));
                        if (user) {
                            const selectedBtn = document.getElementById(`listen-${i}-${user}`);
                            if (user === correct) { totalBenar++; selectedBtn.classList.add('benar'); }
                            else selectedBtn.classList.add('salah');
                        }
                    }
                }

                // 3. Pilihan Ganda
                for (let i=0; i<10; i++) {
                    const user = pgUserAnswers[i];
                    const correct = pgData[i].jawab;
                    const parent = document.querySelector(`[data-pg="${i}"]`);
                    if (parent) {
                        const btns = parent.querySelectorAll('.btn-pilih');
                        btns.forEach(b => b.classList.remove('benar','salah'));
                        if (user) {
                            btns.forEach(b => {
                                if (b.innerText.startsWith(user.toUpperCase()+'.')) {
                                    if (user === correct) { totalBenar++; b.classList.add('benar'); }
                                    else b.classList.add('salah');
                                }
                            });
                        }
                    }
                }

                // 4. Isian Hanzi
                for (let i=0; i<10; i++) {
                    const inp = document.getElementById(`isian-${i}`);
                    if (inp) {
                        inp.classList.remove('benar','salah');
                        const userAns = inp.value.trim();
                        const correct = inp.dataset.jawaban;
                        if (userAns === correct) { totalBenar++; inp.classList.add('benar'); }
                        else if (userAns !== '') inp.classList.add('salah');
                    }
                }

                // 5. Mengetik Hanzi
                for (let i=0; i<10; i++) {
                    const inp = document.getElementById(`hanziInput${i}`);
                    const correct = hanziFromPinyin[i].hanzi;
                    inp.classList.remove('benar','salah');
                    if (inp.value.trim() === correct) { totalBenar++; inp.classList.add('benar'); }
                    else if (inp.value.trim() !== '') inp.classList.add('salah');
                }

                // 6. Indonesia ‚Üí Hanzi
                for (let i=0; i<10; i++) {
                    const inp = document.getElementById(`indoInput${i}`);
                    const correct = indoToHanzi[i].hanzi;
                    inp.classList.remove('benar','salah');
                    if (inp.value.trim() === correct) { totalBenar++; inp.classList.add('benar'); }
                    else if (inp.value.trim() !== '') inp.classList.add('salah');
                }

                // 7. Menjodohkan set1
                for (let leftIdx=0; leftIdx<5; leftIdx++) {
                    const leftEl = document.getElementById(`left-s1-${leftIdx}`);
                    if (!leftEl) continue;
                    const leftText = leftEl.getAttribute('data-left-text');
                    const rightText = pairSet1[leftIdx];
                    leftEl.classList.remove('benar','salah');
                    if (rightText) {
                        const correctRight = window.pairMaps1[leftText];
                        const rightEls = document.querySelectorAll(`#right-s1 .pair-item-right`);
                        rightEls.forEach(el => el.classList.remove('benar','salah'));
                        if (rightText === correctRight) { 
                            totalBenar++; 
                            leftEl.classList.add('benar'); 
                            rightEls.forEach(el => {
                                if (el.getAttribute('data-right-text') === rightText) el.classList.add('benar');
                            });
                        } else {
                            leftEl.classList.add('salah');
                            rightEls.forEach(el => {
                                if (el.getAttribute('data-right-text') === rightText) el.classList.add('salah');
                            });
                        }
                    }
                }
                // set2
                for (let leftIdx=0; leftIdx<5; leftIdx++) {
                    const leftEl = document.getElementById(`left-s2-${leftIdx}`);
                    if (!leftEl) continue;
                    const leftText = leftEl.getAttribute('data-left-text');
                    const rightText = pairSet2[leftIdx];
                    leftEl.classList.remove('benar','salah');
                    if (rightText) {
                        const correctRight = window.pairMaps2[leftText];
                        const rightEls = document.querySelectorAll(`#right-s2 .pair-item-right`);
                        rightEls.forEach(el => el.classList.remove('benar','salah'));
                        if (rightText === correctRight) { 
                            totalBenar++; 
                            leftEl.classList.add('benar'); 
                            rightEls.forEach(el => {
                                if (el.getAttribute('data-right-text') === rightText) el.classList.add('benar');
                            });
                        } else {
                            leftEl.classList.add('salah');
                            rightEls.forEach(el => {
                                if (el.getAttribute('data-right-text') === rightText) el.classList.add('salah');
                            });
                        }
                    }
                }

                const persen = (totalBenar / totalSoal * 100).toFixed(1);
                const lulus = persen >= 80 ? 'üéâ LULUS (‚â•80%)' : '‚ùå BELUM LULUS (target 80%)';
                const laporanDiv = document.getElementById('laporanGlobal');
                laporanDiv.style.display = 'block';
                let reviewButton = '';
                if (persen >= 80) {
                    reviewButton = '<button id="reviewBtn" class="btn-review" onclick="window.scrollTo({top: 0, behavior: \'smooth\'});"><i class="fas fa-search"></i> Review Soal</button>';
                }
                laporanDiv.innerHTML = `<h2><i class="fas fa-clipboard-check"></i> HASIL AKHIR</h2>
                    <p style="font-size:2.5rem; margin:20px 0;">${totalBenar} / ${totalSoal} = ${persen}%</p>
                    <p style="font-size:2rem; background: ${persen>=80?'#1f7a1f':'#b71c1c'}; padding:15px; border-radius:60px;">${lulus}</p>
                    ${reviewButton}`;
                clearInterval(timerInterval);
            };
            document.getElementById('submitGlobalBtn').addEventListener('click', evaluasiGlobal);
            window.pairMaps1 = {}; set1Pairs.forEach(p => { window.pairMaps1[p.left] = p.right; });
            window.pairMaps2 = {}; set2Pairs.forEach(p => { window.pairMaps2[p.left] = p.right; });
        })();
    </script>

    <script>
        // Proteksi tambahan untuk semua browser
        document.addEventListener('contextmenu', e => e.preventDefault());
        document.addEventListener('copy', e => e.preventDefault());
        document.addEventListener('cut', e => e.preventDefault());
        document.addEventListener('selectstart', e => e.preventDefault());
        document.addEventListener('dragstart', e => e.preventDefault());
    </script>
</body>
</html>